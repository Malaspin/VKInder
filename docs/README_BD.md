# üóÑÔ∏è –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL –≤ –ø—Ä–æ–µ–∫—Ç–µ VKinder Bot, –≤–∫–ª—é—á–∞—é—â–∞—è:
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î
- **API** - –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –±–æ—Ç–æ–º
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∏ –ø—Ä–∏–º–µ—Ä—ã

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[DATABASE_API_GUIDE.md](DATABASE_API_GUIDE.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ API –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **[DATABASE_CLI_GUIDE.md](DATABASE_CLI_GUIDE.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ CLI –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **[README_BOT.md](README_BOT.md)** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–æ—Ç—É

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ë–î
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
```bash
python db_cli.py create
```

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤
```bash
python database_examples.py
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ database_interface.py          # –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ë–î
‚îú‚îÄ‚îÄ db_api.py                      # API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ db_cli.py                      # CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ database_examples.py           # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ test_database_simulation.py    # –¢–µ—Å—Ç–æ–≤–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
‚îú‚îÄ‚îÄ env.example                   # –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îú‚îÄ‚îÄ .gitignore                    # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Git
‚îî‚îÄ‚îÄ README.md                     # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### DatabaseInterface
–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL**

### PostgreSQLManager
–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostgreSQL:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PostgreSQL
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Homebrew
- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ PostgreSQL

### CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (db_cli.py)
–ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î:
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
python db_cli.py info              # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ë–î
python db_cli.py create            # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
python db_cli.py clear <table>     # –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
python db_cli.py logs --limit 10   # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

# –ö–æ–º–∞–Ω–¥—ã PostgreSQL
python db_cli.py postgres-start    # –ó–∞–ø—É—Å–∫ PostgreSQL
python db_cli.py postgres-stop     # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
python db_cli.py postgres-status   # –°—Ç–∞—Ç—É—Å PostgreSQL
python db_cli.py postgres-info     # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ PostgreSQL
```

### API (db_api.py)
–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –±–æ—Ç–æ–º:
```python
from database.db_api import *

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
save_user(user_data)               # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
get_user(user_id)                  # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
get_all_users()                    # –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–º
add_to_favorites(user_id, favorite_id)  # –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
get_favorites(user_id, limit=10)         # –ü–æ–ª—É—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö
remove_from_favorites(user_id, favorite_id)  # –£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
is_in_favorites(user_id, target_id)      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–Ω—ã–º —Å–ø–∏—Å–∫–æ–º
add_to_blacklist(user_id, blacklisted_id)    # –î–æ–±–∞–≤–∏—Ç—å –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
get_blacklist(user_id)                       # –ü–æ–ª—É—á–∏—Ç—å —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
remove_from_blacklist(user_id, blacklisted_id)  # –£–¥–∞–ª–∏—Ç—å –∏–∑ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
is_user_blacklisted(user_id, target_id)     # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
save_photos(user_id, photos_data)   # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
get_photos(user_id)                 # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
save_user_settings(user_id, settings)  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
get_user_settings(user_id)             # –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
get_database_stats()                 # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î
get_table_list()                    # –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
get_table_info(table_name)          # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∞–±–ª–∏—Ü–µ
get_all_tables_info()               # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ)
```

## ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:

#### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL**
```python
# –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ DatabaseInterface
postgres_manager = PostgreSQLManager()
postgres_manager.ensure_postgresql_running()  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL
```

#### 2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
```python
# –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
postgres_manager.create_database_if_not_exists()  # –°–æ–∑–¥–∞–µ—Ç 'vkinder_db' –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

#### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü**
```python
# –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ DatabaseInterface
Base.metadata.create_all(engine)  # –°–æ–∑–¥–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –º–æ–¥–µ–ª–µ–π
```

#### 4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏**
```python
# –í—Å–µ API —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏
with db.get_session() as session:
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏
    pass
```

### üîß –†—É—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:

#### 1. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ CLI**
```bash
python src/database/db_cli.py create
```

#### 2. **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
```bash
python src/database/db_cli.py clear
```

#### 3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PostgreSQL**
```bash
python src/database/db_cli.py postgres-start
python src/database/db_cli.py postgres-stop
python src/database/db_cli.py postgres-status
```

#### 4. **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤**
```bash
python src/database/db_cli.py logs --limit 20
```

### üöÄ –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DatabaseInterface**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PostgreSQL
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL (–µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω)
   - –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç)

2. **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–±–æ—Ç–µ**
   - –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
   - API –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã:
- **vk_users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **photos** - –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ª–∞–π–∫–æ–≤/–¥–∏–∑–ª–∞–π–∫–æ–≤)
- **favorites** - –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **blacklisted** - –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
- **search_history** - –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ (—Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏)
- **user_settings** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º–∏ –ø–æ–∏—Å–∫–∞)
- **bot_logs** - –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
- **bot_messages** - –°–æ–æ–±—â–µ–Ω–∏—è

### üÜï –ù–æ–≤—ã–µ –ø–æ–ª—è:
- **photos**: `updated_at`
- **search_history**: `relationship_status`, `has_photo`, `online`
- **user_settings**: `relationship_status`, `has_photo`, `online`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤
```bash
python database_examples.py
```

### –°–∏–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
```bash
python test_database_simulation.py
```

### CLI –∫–æ–º–∞–Ω–¥—ã
```bash
python db_cli.py info
python db_cli.py logs --limit 5
python db_cli.py messages 123456
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **`DATABASE_INTERFACE_GUIDE.md`** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- **`DATABASE_COMMANDS_REFERENCE.md`** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥
- **`DATABASE_QUICKSTART.md`** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **`database_examples.py`** - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –§–∞–π–ª .env
```env
# PostgreSQL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
DB_HOST=localhost
DB_PORT=5432
DB_NAME=vkinder_db
DB_USER=vkinder_user
DB_PASSWORD=vkinder123
```

### –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –±–∞–∑—ã
createdb vkinder_db
createuser vkinder_user
psql -c "ALTER USER vkinder_user PASSWORD 'vkinder123';"
psql -c "GRANT ALL PRIVILEGES ON DATABASE vkinder_db TO vkinder_user;"
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```bash
python db_cli.py info
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
python db_cli.py logs --limit 20
python db_cli.py logs --level error
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
```bash
python db_cli.py messages 123456
```

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
```bash
python db_cli.py create
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
python db_cli.py clear bot_logs
python db_cli.py clear-all
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
```bash
python db_cli.py drop
```

## üìà –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π CRUD** –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ **API** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –∏ –ø—Ä–∏–º–µ—Ä—ã
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏ —Å–∏–º—É–ª—è—Ü–∏—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL**
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PostgreSQL —á–µ—Ä–µ–∑ API**
- ‚úÖ **CLI –∫–æ–º–∞–Ω–¥—ã –¥–ª—è PostgreSQL**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î**

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ PostgreSQL
brew services list | grep postgresql
brew services start postgresql
```

### –û—à–∏–±–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
createdb vkinder_db
createuser vkinder_user
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã
python db_cli.py drop
python db_cli.py create
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º

### –ú–æ–¥—É–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **–§–∞–π–ª:** `src/bot/database_integration.py`
- **–§—É–Ω–∫—Ü–∏–∏:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** Graceful fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î
- **–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** Foreign key constraint errors, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã

#### **üìä –¢–∞–±–ª–∏—Ü–∞ `vk_users`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
user_data = {
    'id': user_id,
    'first_name': user['first_name'],
    'last_name': user['last_name'],
    'age': age,
    'sex': user.get('sex', 0),
    'city': city,
    'city_id': city_id,
    'country': user.get('country', ''),
    'bdate': user.get('bdate', ''),
    'photo_url': f"https://vk.com/images/camera_200.png",
    'profile_url': f"https://vk.com/id{user_id}",
    'is_closed': user.get('is_closed', False),
    'can_access_closed': user.get('can_access_closed', False)
}
self.db.save_user(user_data)
```

#### **üì∏ –¢–∞–±–ª–∏—Ü–∞ `photos`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
photos_data = []
for photo in top_photos:
    photo_data = {
        'url': max_size['url'],
        'type': 'profile',
        'likes': photo.get('likes', {}).get('count', 0)
    }
    photos_data.append(photo_data)
self.db.save_photos(user_id, photos_data)
```

#### **‚ù§Ô∏è –¢–∞–±–ª–∏—Ü–∞ `favorites`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
self.db.add_to_favorites(user_id, person_id)
```

#### **üö´ –¢–∞–±–ª–∏—Ü–∞ `blacklisted`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
self.db.add_to_blacklist(user_id, person_id)
```

#### **üîç –¢–∞–±–ª–∏—Ü–∞ `search_history`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞
search_data = {
    'user_id': user_id,
    'search_params': search_params,
    'results_count': len(results),
    'timestamp': datetime.now()
}
self.db.save_search_history(search_data)
```

#### **‚öôÔ∏è –¢–∞–±–ª–∏—Ü–∞ `user_settings`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
settings_data = {
    'user_id': user_id,
    'min_age': min_age,
    'max_age': max_age,
    'sex_preference': sex_preference,
    'city_preference': city_preference
}
self.db.save_user_settings(settings_data)
```

#### **üìù –¢–∞–±–ª–∏—Ü–∞ `bot_logs`:**
```python
# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
self.db.log_to_database("info", "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω–∏–ª –ø–æ–∏—Å–∫", user_id)
```

#### **üí¨ –¢–∞–±–ª–∏—Ü–∞ `bot_messages`:**
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç–∞
self.db.save_bot_message(user_id, "command", message_text)
self.db.save_bot_message(user_id, "response", response_text)
```

## üîß –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 10. üóÑÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 11. üèóÔ∏è –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ë–î

# –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 12. üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ë–î
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PostgreSQL
```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 13. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 14. üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL

# –°—Ç–∞—Ç—É—Å PostgreSQL
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 15. üìä –°—Ç–∞—Ç—É—Å PostgreSQL
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 16. üßπ –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ë–î

# –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 20. üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ë–î
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 17. üìã –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ë–î

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ë–î
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 18. üë• –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ë–î

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –ë–î
python BOT_BEGIN.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 19. üí¨ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –ë–î
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
```bash
# –û—à–∏–±–∫–∞: No module named 'database_interface'
# –†–µ—à–µ–Ω–∏–µ: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ src –¥–æ–±–∞–≤–ª–µ–Ω –≤ sys.path
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å PostgreSQL
```bash
# –û—à–∏–±–∫–∞: PostgreSQL –Ω–µ –∑–∞–ø—É—â–µ–Ω
# –†–µ—à–µ–Ω–∏–µ: brew services start postgresql
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
```bash
# –û—à–∏–±–∫–∞: –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
# –†–µ—à–µ–Ω–∏–µ: python db_cli.py create
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
```bash
# –û—à–∏–±–∫–∞: Permission denied
# –†–µ—à–µ–Ω–∏–µ: –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
```

## üìã –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### CLI –∫–æ–º–∞–Ω–¥—ã (db_cli.py)

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|----------|
| `python db_cli.py info` | - | –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö –ë–î |
| `python db_cli.py create` | - | –°–æ–∑–¥–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `python db_cli.py drop` | - | –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º) |
| `python db_cli.py clear <table>` | `table` - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã | –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É |
| `python db_cli.py clear-all` | - | –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º) |
| `python db_cli.py test-data` | - | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `python db_cli.py logs` | `--user <id>` `--level <level>` `--limit <n>` | –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ |
| `python db_cli.py messages <user_id>` | `--limit <n>` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `python db_cli.py favorites <user_id>` | - | –ü–æ–∫–∞–∑–∞—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### –ü—Ä–∏–º–µ—Ä—ã CLI –∫–æ–º–∞–Ω–¥:
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ë–î
python db_cli.py info

# –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ª–æ–≥–æ–≤
python db_cli.py clear bot_logs

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
python db_cli.py logs --user 123456 --limit 10

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—à–∏–±–æ–∫
python db_cli.py logs --level error --limit 5

# –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
python db_cli.py messages 123456 --limit 20
```

## üíª API —Ñ—É–Ω–∫—Ü–∏–∏ (db_api.py)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|------------|----------|
| `test_database()` | - | `bool` | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î |
| `create_database()` | - | `bool` | –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü |
| `drop_database()` | - | `bool` | –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü |
| `clear_table(table_name)` | `table_name: str` | `bool` | –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã |
| `clear_all_tables()` | - | `bool` | –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü |
| `get_database_info()` | - | `dict` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∞–±–ª–∏—Ü–∞—Ö |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|------------|----------|
| `add_user(vk_user_id, first_name, last_name, age, sex, city, country, photo_url)` | `vk_user_id: int`<br>`first_name: str`<br>`last_name: str`<br>`age: int` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)<br>`sex: int` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)<br>`city: str` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)<br>`country: str` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)<br>`photo_url: str` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `bool` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `get_user(vk_user_id)` | `vk_user_id: int` | `dict` –∏–ª–∏ `None` | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID |
| `update_user(vk_user_id, **kwargs)` | `vk_user_id: int`<br>`**kwargs` - –ø–æ–ª—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | `bool` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `delete_user(vk_user_id)` | `vk_user_id: int` | `bool` | –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|------------|----------|
| `log_info(message, user_id)` | `message: str`<br>`user_id: int = 0` | `bool` | –ó–∞–ø–∏—Å—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞ |
| `log_debug(message, user_id)` | `message: str`<br>`user_id: int = 0` | `bool` | –ó–∞–ø–∏—Å—å –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ –ª–æ–≥–∞ |
| `log_error(message, user_id)` | `message: str`<br>`user_id: int = 0` | `bool` | –ó–∞–ø–∏—Å—å –ª–æ–≥–∞ –æ—à–∏–±–∫–∏ |
| `log_warning(message, user_id)` | `message: str`<br>`user_id: int = 0` | `bool` | –ó–∞–ø–∏—Å—å –ª–æ–≥–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è |
| `get_logs(user_id, level, limit)` | `user_id: int = 0`<br>`level: str = None`<br>`limit: int = 100` | `list` | –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ |

### –°–æ–æ–±—â–µ–Ω–∏—è

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|------------|----------|
| `add_message(user_id, message_type, message_text)` | `user_id: int`<br>`message_type: str`<br>`message_text: str` | `bool` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è |
| `get_user_messages(user_id, limit)` | `user_id: int`<br>`limit: int = 50` | `list` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### –ò–∑–±—Ä–∞–Ω–Ω–æ–µ

| –§—É–Ω–∫—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|------------|----------|
| `add_favorite(user_id, favorite_id)` | `user_id: int`<br>`favorite_id: int` | `bool` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ |
| `get_favorites(user_id)` | `user_id: int` | `list` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö |
| `remove_favorite(user_id, favorite_id)` | `user_id: int`<br>`favorite_id: int` | `bool` | –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ |

## üêç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from db_api import *

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
if test_database():
    print("‚úÖ –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç")

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ë–î
info = get_database_info()
print(f"–¢–∞–±–ª–∏—Ü: {info['total_tables']}")
```

### –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
add_user(123456, "–ò–≤–∞–Ω", "–ü–µ—Ç—Ä–æ–≤", 30, 2, "–ú–æ—Å–∫–≤–∞")

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user = get_user(123456)
if user:
    print(f"–ù–∞–π–¥–µ–Ω: {user['first_name']} {user['last_name']}")

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
update_user(123456, age=31, city="–°–ü–±")
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
log_info("–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞")
log_error("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")

# –õ–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
log_info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –≤ –±–æ—Ç–∞", 123456)
log_debug("–ù–∞—á–∞–ª–æ –ø–æ–∏—Å–∫–∞", 123456)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤
logs = get_logs(user_id=123456, limit=10)
error_logs = get_logs(level="error", limit=5)
```

### –°–æ–æ–±—â–µ–Ω–∏—è
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
add_message(123456, "command", "/start")
add_message(123456, "response", "–ü—Ä–∏–≤–µ—Ç!")

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
messages = get_user_messages(123456, limit=20)
```

### –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
add_favorite(123456, 789012)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö
favorites = get_favorites(123456)

# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
remove_favorite(123456, 789012)
```

## üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–∞–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
```python
# –°–æ–∑–¥–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
create_database()
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```python
# –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
clear_table("bot_logs")

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
clear_all_tables()
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
```python
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
drop_database()
```

## üìä –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `vk_user_id`: `int` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è VK
- `first_name`: `str` - –ò–º—è
- `last_name`: `str` - –§–∞–º–∏–ª–∏—è
- `age`: `int` - –í–æ–∑—Ä–∞—Å—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `sex`: `int` - –ü–æ–ª: 1 - –∂–µ–Ω—Å–∫–∏–π, 2 - –º—É–∂—Å–∫–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `city`: `str` - –ì–æ—Ä–æ–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `country`: `str` - –°—Ç—Ä–∞–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `photo_url`: `str` - URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π
- `"command"` - –ö–æ–º–∞–Ω–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `"response"` - –û—Ç–≤–µ—Ç –±–æ—Ç–∞
- `"error"` - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `"info"` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `"debug"` - –û—Ç–ª–∞–¥–∫–∞
- `"error"` - –û—à–∏–±–∫–∞
- `"warning"` - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

## üêò –ö–æ–º–∞–Ω–¥—ã PostgreSQL

### CLI –∫–æ–º–∞–Ω–¥—ã PostgreSQL

| –ö–æ–º–∞–Ω–¥–∞           | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ                                                              | –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è                                     |
| :---------------- | :-------- | :-------------------------------------------------------------------- | :------------------------------------------------------- |
| `postgres-start`  | `-`       | –ó–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä.                                          | `python db_cli.py postgres-start`                        |
| `postgres-stop`   | `-`       | –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä.                                      | `python db_cli.py postgres-stop`                         |
| `postgres-restart`| `-`       | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä.                                     | `python db_cli.py postgres-restart`                      |
| `postgres-status` | `-`       | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å PostgreSQL —Å–µ—Ä–≤–µ—Ä–∞.                                 | `python db_cli.py postgres-status`                       |
| `postgres-info`  | `-`       | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ PostgreSQL.                         | `python db_cli.py postgres-info`                         |

### API —Ñ—É–Ω–∫—Ü–∏–∏ PostgreSQL

| –§—É–Ω–∫—Ü–∏—è           | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ                                                              | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç                               |
| :---------------- | :-------- | :-------------------------------------------------------------------- | :--------------------------------------- |
| `start_postgresql()` | `-`       | –ó–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä.                                          | `bool`                                   |
| `stop_postgresql()`  | `-`       | –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä.                                      | `bool`                                   |
| `restart_postgresql()` | `-`      | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL —Å–µ—Ä–≤–µ—Ä.                                     | `bool`                                   |
| `check_postgresql_status()` | `-`   | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å PostgreSQL —Å–µ—Ä–≤–µ—Ä–∞.                                 | `bool`                                   |
| `get_postgresql_info()` | `-`     | –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ PostgreSQL.                          | `Dict[str, Any]`                         |
| `create_database_if_not_exists()` | `-` | –°–æ–∑–¥–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.                         | `bool`                                   |
| `ensure_postgresql_ready()` | `-`  | –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ PostgreSQL –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.                         | `bool`                                   |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PostgreSQL

#### CLI –∫–æ–º–∞–Ω–¥—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PostgreSQL
python db_cli.py postgres-status

# –ó–∞–ø—É—Å–∫ PostgreSQL
python db_cli.py postgres-start

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ PostgreSQL
python db_cli.py postgres-info

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
python db_cli.py postgres-stop
```

#### API —Ñ—É–Ω–∫—Ü–∏–∏
```python
from db_api import *

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
status = check_postgresql_status()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
info = get_postgresql_info()

# –ó–∞–ø—É—Å–∫ PostgreSQL
start_postgresql()

# –ì–∞—Ä–∞–Ω—Ç–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
ensure_postgresql_ready()
```

## üîß –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### üìù –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞

#### **–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞** - –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ
- ‚úÖ **–ü—Ä–æ–ø—É—Å–∫ –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ "–î–∞–ª–µ–µ" –∏ "–ù–∞–∑–∞–¥"
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** - ID, –∏–º—è, —Ñ–∞–º–∏–ª–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–°—á–µ—Ç—á–∏–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** - —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–æ–∏—Å–∫–æ–º –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

#### **–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –õ–æ–≥–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ø–æ–∏—Å–∫–∞
INSERT INTO bot_logs (level, message, user_id, created_at) 
VALUES ('INFO', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 12345 –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ –ø–æ–∏—Å–∫–∞ - –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ', 67890, NOW());

-- –õ–æ–≥–∏ –ø—Ä–æ–ø—É—Å–∫–∞ –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
INSERT INTO bot_logs (level, message, user_id, created_at) 
VALUES ('INFO', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 54321 –ø—Ä–æ–ø—É—â–µ–Ω –∏–∑-–∑–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞', 67890, NOW());

-- –õ–æ–≥–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞–∑–∞–¥
INSERT INTO bot_logs (level, message, user_id, created_at) 
VALUES ('INFO', '–ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞–∑–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 98765 –ø—Ä–æ–ø—É—â–µ–Ω –∏–∑-–∑–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞', 67890, NOW());
```

#### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
```python
# –í –º–µ—Ç–æ–¥–µ search_users()
for person in unique_results:
    if person['id'] not in blacklisted_ids:
        filtered_results.append(person)
    else:
        excluded_count += 1
        self.logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {person['id']} ({person.get('first_name', 'Unknown')} {person.get('last_name', 'Unknown')}) –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ - –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
        self.db.log_to_database('INFO', f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {person['id']} –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ –ø–æ–∏—Å–∫–∞ - –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ", user_id)
```

#### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ **–ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –≤–∏–¥–Ω–æ –∫—Ç–æ –∏ –ø–æ—á–µ–º—É –ø—Ä–æ–ø—É—â–µ–Ω
- ‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** - –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º** - –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –ø–æ—á–µ–º—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∞–Ω–∫–µ—Ç—ã
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –∫–∞–∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤** - —Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–æ–ø—É—â–µ–Ω–æ

### üîß –£–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- **INFO —É—Ä–æ–≤–µ–Ω—å** - –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–ø—É—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **DEBUG —É—Ä–æ–≤–µ–Ω—å** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `bot_logs`
- **–§–∞–π–ª—ã** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

#### **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
- **–ü—Ä–∏ –ø–æ–∏—Å–∫–µ** - "–∏—Å–∫–ª—é—á–µ–Ω –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞"
- **–ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤–ø–µ—Ä–µ–¥** - "–Ω–∞–π–¥–µ–Ω –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ –∏ –ø—Ä–æ–ø—É—â–µ–Ω"
- **–ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞–∑–∞–¥** - "–ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞–∑–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ"

## üîß –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Foreign Key Constraint Errors**

#### **üö® –ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå **–û—à–∏–±–∫–∞:** `insert or update on table 'photos' violates foreign key constraint`
- ‚ùå **–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—ã—Ç–∞–ª–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –±—ã–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `vk_users`
- ‚ùå **–ù–∞—Ä—É—à–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞** `photos_vk_user_id_fkey`

#### **‚úÖ –†–µ—à–µ–Ω–∏–µ:**
```python
# –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
self.db.save_user(person_data)  # –ú–æ–∂–µ—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è
# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å—Ä–∞–∑—É - –û–®–ò–ë–ö–ê!
self.db.save_photos(person['id'], photos_data)  # ‚ùå Foreign key error

# –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
user_saved = self.db.save_user(person_data)  # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if user_saved:  # ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—à–Ω–æ—Å—Ç—å
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω
    self.db.save_photos(person['id'], photos_data)  # ‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫
else:
    self.logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {person['id']}, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏")
```

#### **üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ **–ù–µ—Ç –æ—à–∏–±–æ–∫** `foreign key constraint`
- ‚úÖ **–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –±–µ–∑ –æ—à–∏–±–æ–∫ –ë–î

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ—Ç–æ–¥–∞–º –ë–î**

#### **üö® –ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå **–û—à–∏–±–∫–∞:** `'BotDatabaseIntegration' object has no attribute 'get_user'`
- ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø** –∫ –º–µ—Ç–æ–¥—É `get_user` –≤ `DatabaseInterface`

#### **‚úÖ –†–µ—à–µ–Ω–∏–µ:**
```python
# –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
user_data = self.db.get_user(user_id)  # ‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞

# –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
user_data = self.db.db.get_user(user_id)  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø
```

#### **üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø** –∫ –º–µ—Ç–æ–¥–∞–º `DatabaseInterface`
- ‚úÖ **–†–∞–±–æ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤** —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (üü¢/‚ö™)
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

#### **üìä –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
```python
# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –î–û —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
is_new_user = self.is_new_user(person['id'])  # ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –î–û —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

# 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_saved = self.db.save_user(person_data)

# 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω
if user_saved and photos_data:
    self.db.save_photos(person['id'], photos_data)
```

#### **üì∏ –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π:**
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
existing_photo = session.query(Photo).filter(
    Photo.vk_user_id == user_id,
    Photo.photo_url == photo_data['url']
).first()

if existing_photo:
    # –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤
    existing_photo.likes_count = photo_data['likes']
else:
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
    new_photo = Photo(
        vk_user_id=user_id,
        photo_url=photo_data['url'],
        photo_type=photo_data['type'],
        likes_count=photo_data['likes']
    )
    session.add(new_photo)
```

#### **‚ù§Ô∏è –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:**
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
existing_favorite = session.query(Favorite).filter(
    Favorite.user_id == user_id,
    Favorite.favorite_id == favorite_id
).first()

if existing_favorite:
    # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—Ç—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
    existing_favorite.created_at = datetime.now()
else:
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
    new_favorite = Favorite(
        user_id=user_id,
        favorite_id=favorite_id,
        created_at=datetime.now()
    )
    session.add(new_favorite)
```

### **–¢–æ—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É**

#### **üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
```python
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É (VK API –∏–Ω–æ–≥–¥–∞ –Ω–µ—Ç–æ—á–µ–Ω)
age_filtered_results = []
age_excluded_count = 0
no_bdate_count = 0

for person in unique_results:
    person_age = self.calculate_age(person.get('bdate', ''))
    if person_age and age_from <= person_age <= age_to:
        age_filtered_results.append(person)
    else:
        age_excluded_count += 1
        if person_age:
            self.logger.debug(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {person['id']} –∏—Å–∫–ª—é—á–µ–Ω –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É: {person_age} –ª–µ—Ç")
        else:
            no_bdate_count += 1
            self.logger.debug(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {person['id']} –∏—Å–∫–ª—é—á–µ–Ω - –Ω–µ—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è")

unique_results = age_filtered_results
```

#### **üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞:**
```python
search_params = {
    'q': '',
    'sex': target_sex,
    'age_from': age_from,
    'age_to': age_to,
    'status': 6,  # –Ω–µ –≤ –±—Ä–∞–∫–µ
    'has_photo': 1,
    'online': 0,  # –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–Ω–ª–∞–π–Ω
    'sort': 0,  # –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
    'count': 50,
    'offset': offset,
    'fields': 'city,sex,bdate,photo_200,is_closed,can_access_closed'  # ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—è
}
```

### **–°–∏—Å—Ç–µ–º–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å—Ç–∞—Ç—É—Å–∞**

#### **üéØ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- **‚ù§Ô∏è** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
- **üü¢** - –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–µ –±—ã–ª –≤ `vk_users`)
- **‚ö™** - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—É–∂–µ –±—ã–ª –≤ `vk_users`)

#### **üéÇ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è:**
- **"–°–µ–≥–æ–¥–Ω—è –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è!"** - –µ—Å–ª–∏ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è —Å–µ–≥–æ–¥–Ω—è
- **"–°–∫–æ—Ä–æ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è! [–¥–∞—Ç–∞]"** - –µ—Å–ª–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –¥–Ω–µ–π
- **"–í—á–µ—Ä–∞ –±—ã–ª –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è"** - –µ—Å–ª–∏ –±—ã–ª –≤—á–µ—Ä–∞

### **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ**

#### **üìä –í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–∫–∞–∑–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:**
- **–¢–û–ü-1** - –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π
- **–¢–û–ü-5** - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö
- **–¢–û–ü-10** - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö

#### **üìÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ:**
```python
# –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–µ—Ä–≤—ã–µ)
favorites = session.query(Favorite).filter(
    Favorite.user_id == user_id
).order_by(Favorite.created_at.desc()).limit(limit).all()
```

## üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìä API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **get_user_statistics()** - –±–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **get_user_profile_stats()** - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
- **get_user_activity_summary()** - —Å–≤–æ–¥–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### üìù –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ë–î** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `bot_logs`
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - DEBUG, INFO, WARNING, ERROR
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤
- **–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π

### üîß –£–ª—É—á—à–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- **CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** - —É–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã

### üóÑÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã** - `bot_logs`, `bot_messages`
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è** - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏, —Å—Ç–∞—Ç—É—Å—ã
- **–ò–Ω–¥–µ–∫—Å—ã** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–°–≤—è–∑–∏** - —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

### üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å —á–µ—Ä–Ω—ã–º —Å–ø–∏—Å–∫–æ–º** - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∞—Ç—Ä–∏–±—É—Ç `self.blacklisted`
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ –ª–æ–≥–∞—Ö** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
- **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- **API –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** - –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **–ü–æ–ª–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∞–π–∫–æ–≤** - –ø–æ–∫–∞–∑ —Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–∞–π–∫–æ–≤ –≤–º–µ—Å—Ç–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö** - —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ `KeyError` —Å –ø–æ–ª–æ–º, –≥–æ—Ä–æ–¥–æ–º –∏ –≤–æ–∑—Ä–∞—Å—Ç–æ–º
- **–£–ª—É—á—à–µ–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –Ω–µ–ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ò–Ω–¥–µ–∫—Å—ã** - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–ª—è–º
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ë–∞—Ç—á–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏ –∏ CPU
- **–ê–ª–µ—Ä—Ç—ã** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### CLI –∫–æ–º–∞–Ω–¥—ã
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ë–î
python src/database/db_cli.py create

# –£–¥–∞–ª–µ–Ω–∏–µ –ë–î
python src/database/db_cli.py drop

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
python src/database/db_cli.py test

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü
python src/database/db_cli.py tables

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
python src/database/db_cli.py cleanup
```

### API —Ñ—É–Ω–∫—Ü–∏–∏
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
from src.database.db_api import get_user_statistics
stats = get_user_statistics(user_id)

# –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
from src.database.db_api import save_user, get_user
user_data = {'id': 123, 'first_name': '–ò–≤–∞–Ω', 'last_name': '–ü–µ—Ç—Ä–æ–≤'}
save_user(user_data)
```

## üìä API –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –û–±–∑–æ—Ä
API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ VKinder Bot. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 1. `get_user_statistics(user_id: int) -> dict`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'viewed_profiles': int,      # –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –∞–Ω–∫–µ—Ç—ã
    'favorites_count': int,       # –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º
    'blacklisted_count': int,     # –í —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ
    'viewed_photos': int,        # –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ
    'search_sessions': int       # –ü–æ–∏—Å–∫–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏
}
```

#### 2. `get_user_profile_stats(user_id: int) -> dict`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    # –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    'viewed_profiles': int,
    'favorites_count': int,
    'blacklisted_count': int,
    'viewed_photos': int,
    'search_sessions': int,
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    'total_searches': int,           # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–æ–≤
    'last_search_date': str,         # –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–∏—Å–∫–∞
    'last_search_results': int,      # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–∏—Å–∫–∞
    'user_settings': {               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        'min_age': int,
        'max_age': int,
        'sex_preference': int,
        'city_preference': str,
        'online_only': bool
    }
}
```

#### 3. `get_user_activity_summary(user_id: int) -> dict`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–¥–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'messages_with_bot': int,        # –°–æ–æ–±—â–µ–Ω–∏—è —Å –±–æ—Ç–æ–º
    'bot_logs_count': int,           # –õ–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    'last_activity': str,            # –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    'searches_last_week': int,       # –ü–æ–∏—Å–∫–∏ –∑–∞ –Ω–µ–¥–µ–ª—é
    'messages_last_week': int         # –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞ –Ω–µ–¥–µ–ª—é
}
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```python
from src.database.db_api import get_user_statistics

user_id = 123456789
stats = get_user_statistics(user_id)

print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}:")
print(f"üëÄ –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ –∞–Ω–∫–µ—Ç: {stats.get('viewed_profiles', 0)}")
print(f"‚ù§Ô∏è –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º: {stats.get('favorites_count', 0)}")
print(f"üö´ –í —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ: {stats.get('blacklisted_count', 0)}")
print(f"üì∏ –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ —Ñ–æ—Ç–æ: {stats.get('viewed_photos', 0)}")
print(f"üîç –ü–æ–∏—Å–∫–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π: {stats.get('search_sessions', 0)}")
```

## üìù –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –û–±–∑–æ—Ä
VKinder Bot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∞–π–ª–æ–≤–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### DEBUG - –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –æ–±—ä–µ–∫—Ç–æ–≤
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π –∏ API –≤—ã–∑–æ–≤–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

#### INFO - –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

#### WARNING - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é —Å–µ—Ä–≤–∏—Å–æ–≤
- –ß–∞—Å—Ç–∏—á–Ω—ã–µ —Å–±–æ–∏

#### ERROR - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- –°–±–æ–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–±–ª–µ–º—ã —Å VK API

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

#### –§–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```
logs/
‚îú‚îÄ‚îÄ bot_system_YYYYMMDD_HHMM.log    # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ database_debug_YYYYMMDD_HHMM.log # –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ –ë–î
‚îú‚îÄ‚îÄ bot_info.log                    # INFO –ª–æ–≥–∏ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)
‚îú‚îÄ‚îÄ bot_debug.log                   # DEBUG –ª–æ–≥–∏ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)
‚îú‚îÄ‚îÄ bot_error.log                   # ERROR –ª–æ–≥–∏ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)
‚îî‚îÄ‚îÄ bot_system.log                  # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
–¢–∞–±–ª–∏—Ü–∞ `bot_logs`:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `vk_user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è VK
- `log_level` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `log_message` - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `created_at` - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∫–æ–¥–µ
```python
# –í vk_bot.py
def _setup_logging(self):
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—É—Ñ—Ñ–∏–∫—Å —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
    timestamp_suffix = self._get_timestamp_suffix()
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    log_level = logging.DEBUG if self.debug_mode else logging.INFO
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    logging.basicConfig(
        level=log_level,
        format='%(asctime)s | %(levelname)-8s | %(name)s:%(funcName)s:%(lineno)d - %(message)s',
        handlers=[
            # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
            logging.StreamHandler(),
            # –§–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
            logging.FileHandler(f'logs/bot_system{timestamp_suffix}.log', encoding='utf-8')
        ]
    )
```

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –í .env —Ñ–∞–π–ª–µ
LOG_LEVEL=INFO                    # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_TO_DB=true                   # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ë–î
DEBUG_MODE=false                 # –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π.

---
*–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º!*
